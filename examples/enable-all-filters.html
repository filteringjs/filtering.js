<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>filtering.js - Check all filters - Example</title>

    <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
    <link rel="stylesheet" href="../dist/example-style.css">
    <script src="../dist/index.js"></script>
</head>
<body>

<div id="root">
    <div id="filtering">
        <div class="filtering-group" data-group-name="color">
            <div class="filtering-filter" data-filter-name="red">Red</div>
            <div class="filtering-filter" data-filter-name="blue">Blue</div>
            <div class="filtering-filter" data-filter-type="all">All</div>
        </div>
        <div class="filtering-group" data-group-name="size">
            <div class="filtering-filter" data-filter-name="small">Small</div>
            <div class="filtering-filter" data-filter-name="large">Large</div>
            <div class="filtering-filter" data-filter-type="all">All</div>
        </div>
    </div>

    <div id="items">
        <div id="item-1" class="filtering-item" data-filter-color="red" data-filter-size="small"></div>
        <div id="item-2" class="filtering-item" data-filter-color="blue" data-filter-size="large"></div>
    </div>
</div>

<script>
    const {FilteringFlow} = filteringjs;

    class MyFlow extends FilteringFlow {
        initializeFilterListener() {
            for (const filterElement of this.root.getElementsByClassName(this.parser.options.filterClass)) {
                filterElement.addEventListener('click', (event) => {
                    event.preventDefault();
                    if (filterElement.classList.contains(this.options.disabledFilterClass)) {
                        // Ignore click if the filter would give 0 results
                        return;
                    }
                    if (filterElement.dataset.filterType === 'all') {
                        // Remove all checked classes in group if all is clicked
                        if (!filterElement.classList.contains(this.parser.options.filterCheckedClass)) {
                            for (const fe of filterElement.closest(`.${this.parser.options.groupClass}`).getElementsByClassName(this.parser.options.filterClass)) {
                                fe.classList.remove(this.parser.options.filterCheckedClass);
                            }
                        }
                    } else {
                        filterElement.classList.toggle(this.parser.options.filterCheckedClass); // Check or uncheck filter
                    }
                    this.filter();
                });
            }
        }
    }

    new MyFlow(document.querySelector('#root'));
</script>

</body>
</html>
